ПЕРВАЯ ЧАСТЬ ПРОЕКТА.

Работа с проектом осуществлялась на ПК в программе PyCharm 2025.1.2 либо в Google Colab.
Для работы на ПК необходимо установить соответствующие пакеты.
Для работы в Colab необходимо изменить пути к директориям с изображениями и файлам csv.
В представленной версии все пути для текущей папки проекта, где находятся:
- директория archive с полным датасетом CelebA;
- файл с атрибутами list_attr_celeba.csv;
- файл с идентификаторами изображений identit_CelebA.txt;
- файл с bbox изображений list_bbox_celeba.csv;
- файл с координатами ключевых точек лица list_landmarks_celeba.txt.

Открываем файл ноутбука step_1.ipynb
Загружаем в датафрейм df_attr данные об атрибутах, в df_id данные идентификаторов.
Выбираем необходимые атрибуты, объединяем датафреймы, выбираем 75000 изображений с учетом выбранных критериевб
отбираем лиц, у которых представлено более 25 изображений.
В итоге получилась выборка 10528 изображений для 397 персон.
Выбранные изображения скопированы в папку selected_images, информация в файл selected_images_info.csv

Далее обрезаем изображения по размеру bbox (значения берем из файла list_bbox_celeba.csv и
пересчитываем значения ключевых точек из файла list_landmarks_celeba.txt. 
Новые значения сохраняем в файл cropped_landmarks.csv, кропнутые изображения копируем в папку
cropped_images, данные сохраняем в файл cropped_images.
Визуализируем результаты обрезки и пересчета координат точек на примерах.


Далее реализуем и обучаем Stacked Hourglass Network для поиска ключевых точек лица.
При выполнении кода в Colab необходимо изменить среду выполнения на GPU T4 и изменить пути к папкам и файлам!
Данный пример выполнен на ПК.
В данном разделе кода реализовано:
- загрузка кропнутых по лицу изображений и координат ключевых точек из файла cropped_landmarks.csv;
- преобразование точек лица в Heatmap;
- Hourglass блок;
- Stacked Hourglass;
- обучение Stacked Hourglass;
- тестирование обученной модели.

Далее выравниваем обрезанные фотографии по линии глаз с использованием предсказанных обученной
моделью ключевых точек лица.
Выравнивание изображений реализовано путем вычисления угла поворота по линии глаз, поворота
на вычисленный угол и обрезки по размеру лица.
В целом модель справилась неплохо, однако некоторые изображения для нее оказались трудными, возможно из-за очков, ракурса, макияжа.
Например: 120599, 134610, 155409, 162428, 191672, 198940.

ВТОРАЯ ЧАСТЬ ПРОЕКТА.

Открываем файл ноутбука step_2.ipynb
В данной части создается датасет из выравненных изображений по условию >26 снимков на персону
В результате обучения модели с CrossEntropyLoss на 15 эпохах достигнут точность 73,28%
Для обучения модель c ArcFaceLoss загружаются веса с обученной модели CE/
На 10 эпохах достигнута точность 72,13%.
Качество эмбеддингов:
- средняя косинусная схожесть внутри класса: 0.6762
- средняя косинусная схожесть между классами: 0.3631
  Ratio (inter/intra): 0.54

ТРЕТЬЯ ЧАСТЬ ПРОЕКТА.
Открываем файл ноутбука step_3.ipynb
для примера использовалось фотография группы Beatls и одиночная фотография Пола Маккартни
Лучшее совпадение:
  Лицо 3 (Img1) vs Лицо 1 (Img2)
  Косинусное сходство: 0.453
  Вероятность того же человека: 72.6%
Модель правильно установила сходство
Небольшая проблема с цветопередачей, но уже нет времени разбираться 


